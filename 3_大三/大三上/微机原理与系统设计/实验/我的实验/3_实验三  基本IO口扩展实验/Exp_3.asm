IO244	EQU	0230H	;74LS244端口地址
IO273	EQU	0230H	;74LS273端口地址

_STACK	SEGMENT	STACK
		DW	100	DUP(?)
_STACK	ENDS

_DATA	SEGMENT WORD	 PUBLIC 'DATA'
_DATA	ENDS

CODE		SEGMENT
ASSUME CS:CODE, DS:_DATA, SS:_STACK
START	PROC	 NEAR
		MOV	AX, _DATA
        	MOV DS, AX
INPUT:	
		MOV	DX, IO244
		IN	AX, DX
		CMP	AX, 0H 
		JZ LEFT
		CMP	AX, 0FFFFH
		JZ RIGHT	

		MOV	DX, IO273
		OUT	DX, AX
		JMP	INPUT
LEFT:
		MOV	AX, 7FFFH
		MOV	DX, IO273
RIGHT2LEFT:
		CALL	 DELAY		
		OUT	DX, AX		
		ROL	AX, 1
		CMP	AX, 7FFFH
		JNE	RIGHT2LEFT		
		JMP	INPUT
		
RIGHT:
		MOV	AX, 0FFFEH
		MOV	DX, IO273
LEFT2RIGHT:
		CALL	 DELAY
		OUT	DX, AX
		ROR	AX, 1
		CMP	AX, 0FFFEH
		JNE	LEFT2RIGHT		
		JMP	INPUT		
LEFT_2:
		MOV	AX, 03FFFH
		MOV	DX, IO273
RIGHT2LEFT_2:
		CALL	 DELAY		
		OUT	DX, AX		
		ROL	AX, 1
		ROL	AX, 1
		CMP	AX, 03FFFH
		JNE	RIGHT2LEFT_2			
		JMP	INPUT 
RIGHT_2:
		MOV	AX, 0FFFCH
		MOV	DX, IO273
LEFT2RIGHT_2:
		CALL	 DELAY
		OUT	DX, AX
		ROR	AX, 1
		ROR	AX, 1
		CMP	AX, 0FFFCH
		JNE	LEFT2RIGHT_2			
		JMP	INPUT		
Delay 	PROC NEAR			
		LOOP	$
		RET
Delay	ENDP
START	ENDP		
CODE		ENDS		
END		START


